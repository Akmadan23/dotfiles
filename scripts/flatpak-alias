#!/bin/bash

help_msg="USAGE:
    run './flatpak-alias > /path/to/file'
    then add 'source /path/to/file' inside your bashrc or zshrc"

if echo "$1" | grep -Eq "^(-h|--help)$"; then
    echo "$help_msg"
    exit
fi

if ! command -v flatpak &>/dev/null; then
    echo "Error: flatpak is not installed" >&2
    exit 1
fi

echo "# Flatpak aliases (generated by 'flatpak-alias' script)"

# For each flatpak installed (apps only), automatically create a shell alias
flatpak list --app | while read -r line; do
    name="$(echo "$line" | cut -f 1 | sed "s/ /-/g" | tr "[:upper:]" "[:lower:]")"
    id="$(echo "$line" | cut -f 2)"

    echo "alias $name=\"flatpak run $id\""
done
